<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-docs/deploy/aws">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Deploying to AWS | DataHub</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://datahubproject.io/docs/deploy/aws"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploying to AWS | DataHub"><meta data-rh="true" name="description" content="The following is a set of instructions to quickstart DataHub on AWS Elastic Kubernetes Service (EKS). Note, the guide"><meta data-rh="true" property="og:description" content="The following is a set of instructions to quickstart DataHub on AWS Elastic Kubernetes Service (EKS). Note, the guide"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://datahubproject.io/docs/deploy/aws"><link data-rh="true" rel="alternate" href="https://datahubproject.io/docs/deploy/aws" hreflang="en"><link data-rh="true" rel="alternate" href="https://datahubproject.io/docs/deploy/aws" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RK0UG797F3-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="DataHub" href="/opensearch.xml">



<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap"><link rel="stylesheet" href="/assets/css/styles.82aebe9e.css">
<link rel="preload" href="/assets/js/runtime~main.41cec5e1.js" as="script">
<link rel="preload" href="/assets/js/main.528bc9eb.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#070707;color:#ffffff" role="banner"><div class="content_knG7 announcementBarContent_xLdY"><div><img src="/img/acryl-logo-white-mark.svg"><p><strong>Managed DataHub</strong><span> &nbsp;Acryl Data delivers an easy to consume DataHub platform for the enterprise</span></p></div> <a href="https://www.acryldata.io/datahub-sign-up" target="_blank" class="button button--primary">Sign up for Managed DataHub&nbsp;→</a></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/datahub-logo-color-light-horizontal.svg" alt="DataHub Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/datahub-logo-color-dark-horizontal.svg" alt="DataHub Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/demo">Demo</a><a href="https://blog.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://feature-requests.datahubproject.io/roadmap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Roadmap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__slack" aria-label="Slack"></a><a href="https://github.com/datahub-project/datahub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__github" aria-label="GitHub"></a><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__youtube" aria-label="YouTube"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/features">What is DataHub?</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/get-started-with-datahub">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/metadata-ingestion">Ingest Metadata</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/domains">Enrich Metadata</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/act-on-metadata">Act on Metadata</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/deploy/aws">Deploy DataHub</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/deploy/aws">Deploying to AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploy/gcp">Deploying to GCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker">Deploying with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploy/kubernetes">Deploying with Kubernetes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/authentication">Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/authorization">Authorization</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/how/delete-metadata">Advanced Guides</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli">Developer Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/how/search">Feature Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/slack">Join the Community</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/releases">Release History</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Deploy DataHub</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deploying to AWS</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>AWS setup guide</h1><p>The following is a set of instructions to quickstart DataHub on AWS Elastic Kubernetes Service (EKS). Note, the guide
assumes that you do not have a kubernetes cluster set up. If you are deploying DataHub to an existing cluster, please
skip the corresponding sections.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><p>This guide requires the following tools:</p><ul><li><a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">kubectl</a> to manage kubernetes resources</li><li><a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">helm</a> to deploy the resources based on helm charts. Note, we only support Helm
3.</li><li><a href="https://eksctl.io/introduction/#installation" target="_blank" rel="noopener noreferrer">eksctl</a> to create and manage clusters on EKS</li><li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html" target="_blank" rel="noopener noreferrer">AWS CLI</a> to manage AWS resources</li></ul><p>To use the above tools, you need to set up AWS credentials by following
this <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html" target="_blank" rel="noopener noreferrer">guide</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="start-up-a-kubernetes-cluster-on-aws-eks">Start up a kubernetes cluster on AWS EKS<a class="hash-link" href="#start-up-a-kubernetes-cluster-on-aws-eks" title="Direct link to heading">​</a></h2><p>Let’s follow this <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html" target="_blank" rel="noopener noreferrer">guide</a> to create a new
cluster using eksctl. Run the following command with cluster-name set to the cluster name of choice, and region set to
the AWS region you are operating on.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create cluster \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &lt;&lt;cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --region &lt;&lt;region&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --with-oidc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --nodes=3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The command will provision an EKS cluster powered by 3 EC2 m3.large nodes and provision a VPC based networking layer.</p><p>If you are planning to run the storage layer (MySQL, Elasticsearch, Kafka) as pods in the cluster, you need at least 3
nodes. If you decide to use managed storage services, you can reduce the number of nodes or use m3.medium nodes to save
cost. Refer to this <a href="https://eksctl.io/usage/creating-and-managing-clusters/" target="_blank" rel="noopener noreferrer">guide</a> to further customize the cluster
before provisioning.</p><p>Note, OIDC setup is required for following this guide when setting up the load balancer.</p><p>Run <code>kubectl get nodes</code> to confirm that the cluster has been setup correctly. You should get results like below</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                                          STATUS   ROLES    AGE   VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-192-168-49-49.us-west-2.compute.internal   Ready    &lt;none&gt;   3h    v1.18.9-eks-d1db3c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-192-168-64-56.us-west-2.compute.internal   Ready    &lt;none&gt;   3h    v1.18.9-eks-d1db3c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-192-168-8-126.us-west-2.compute.internal   Ready    &lt;none&gt;   3h    v1.18.9-eks-d1db3c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-datahub-using-helm">Setup DataHub using Helm<a class="hash-link" href="#setup-datahub-using-helm" title="Direct link to heading">​</a></h2><p>Once the kubernetes cluster has been set up, you can deploy DataHub and it’s prerequisites using helm. Please follow the
steps in this <a href="/docs/deploy/kubernetes">guide</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="expose-endpoints-using-a-load-balancer">Expose endpoints using a load balancer<a class="hash-link" href="#expose-endpoints-using-a-load-balancer" title="Direct link to heading">​</a></h2><p>Now that all the pods are up and running, you need to expose the datahub-frontend end point by setting
up <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener noreferrer">ingress</a>. To do this, you need to first set up an
ingress controller. There are
many <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/" target="_blank" rel="noopener noreferrer">ingress controllers</a>  to choose
from, but here, we will follow
this <a href="https://docs.aws.amazon.com/eks/latest/userguide/aws-load-balancer-controller.html" target="_blank" rel="noopener noreferrer">guide</a> to set up the AWS
Application Load Balancer(ALB) Controller.</p><p>First, if you did not use eksctl to setup the kubernetes cluster, make sure to go through the prerequisites listed
<a href="https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Download the IAM policy document for allowing the controller to make calls to AWS APIs on your behalf.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -o iam_policy.json https://raw.githubusercontent.com/kubernetes-sigs/aws-load-balancer-controller/v2.2.0/docs/install/iam_policy.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Create an IAM policy based on the policy document by running the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws iam create-policy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --policy-name AWSLoadBalancerControllerIAMPolicy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --policy-document file://iam_policy.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use eksctl to create a service account that allows us to attach the above policy to kubernetes pods.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create iamserviceaccount \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --cluster=&lt;&lt;cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace=kube-system \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name=aws-load-balancer-controller \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --attach-policy-arn=arn:aws:iam::&lt;&lt;account-id&gt;&gt;:policy/AWSLoadBalancerControllerIAMPolicy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --override-existing-serviceaccounts \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --approve      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Install the TargetGroupBinding custom resource definition by running the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -k &quot;github.com/aws/eks-charts/stable/aws-load-balancer-controller//crds?ref=master&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Add the helm chart repository containing the latest version of the ALB controller.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo add eks https://aws.github.io/eks-charts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo update</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Install the controller into the kubernetes cluster by running the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade -i aws-load-balancer-controller eks/aws-load-balancer-controller \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --set clusterName=&lt;&lt;cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --set serviceAccount.create=false \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --set serviceAccount.name=aws-load-balancer-controller \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -n kube-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify the install completed by running <code>kubectl get deployment -n kube-system aws-load-balancer-controller</code>. It should
return a result like the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                           READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws-load-balancer-controller   2/2     2            2           142m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that the controller has been set up, we can enable ingress by updating the values.yaml (or any other values.yaml
file used to deploy datahub). Change datahub-frontend values to the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub-frontend:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  enabled: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  image:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    repository: linkedin/datahub-frontend-react</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tag: &quot;latest&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    annotations:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      kubernetes.io/ingress.class: alb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/scheme: internet-facing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/target-type: instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/certificate-arn: &lt;&lt;certificate-arn&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/inbound-cidrs: 0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/listen-ports: &#x27;[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;:443}]&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/actions.ssl-redirect: &#x27;{&quot;Type&quot;: &quot;redirect&quot;, &quot;RedirectConfig&quot;: { &quot;Protocol&quot;: &quot;HTTPS&quot;, &quot;Port&quot;: &quot;443&quot;, &quot;StatusCode&quot;: &quot;HTTP_301&quot;}}&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hosts:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      - host: &lt;&lt;host-name&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        redirectPaths:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - path: /*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name: ssl-redirect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            port: use-annotation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        paths:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - /*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You need to request a certificate in the AWS Certificate Manager by following this
<a href="https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html" target="_blank" rel="noopener noreferrer">guide</a>, and replace certificate-arn with
the ARN of the new certificate. You also need to replace host-name with the hostname of choice like
demo.datahubproject.io.</p><p>To have the metadata <!-- -->[authentication service]<!-- -->(/docs/authentication/introducing-metadata-service-authentication#Configuring Metadata Service Authentication) enabled and use <!-- -->[API tokens]<!-- -->(/docs/authentication/personal-access-tokens#Generating Personal Access Tokens) from the UI you will need to set the configuration in the values.yaml for the <code>gms</code> and the <code>frontend</code> deployments. This could be done by enabling the <code>metadata_service_authentication</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  metadata_service_authentication:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After updating the yaml file, run the following to apply the updates.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade --install datahub datahub/datahub --values values.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the upgrade completes, run <code>kubectl get ingress</code> to verify the ingress setup. You should see a result like the
following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                       CLASS    HOSTS                         ADDRESS                                                                 PORTS   AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub-datahub-frontend   &lt;none&gt;   demo.datahubproject.io   k8s-default-datahubd-80b034d83e-904097062.us-west-2.elb.amazonaws.com   80      3h5m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note down the elb address in the address column. Add the DNS CNAME record to the host domain pointing the host-name (
from above) to the elb address. DNS updates generally take a few minutes to an hour. Once that is done, you should be
able to access datahub-frontend through the host-name.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-aws-managed-services-for-the-storage-layer">Use AWS managed services for the storage layer<a class="hash-link" href="#use-aws-managed-services-for-the-storage-layer" title="Direct link to heading">​</a></h2><p>Managing the storage services like MySQL, Elasticsearch, and Kafka as kubernetes pods requires a great deal of
maintenance workload. To reduce the workload, you can use managed services like AWS <a href="https://aws.amazon.com/rds" target="_blank" rel="noopener noreferrer">RDS</a>,
<a href="https://aws.amazon.com/elasticsearch-service/" target="_blank" rel="noopener noreferrer">Elasticsearch Service</a>, and <a href="https://aws.amazon.com/msk/" target="_blank" rel="noopener noreferrer">Managed Kafka</a>
as the storage layer for DataHub. Support for using AWS Neptune as graph DB is coming soon.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rds">RDS<a class="hash-link" href="#rds" title="Direct link to heading">​</a></h3><p>Provision a MySQL database in AWS RDS that shares the VPC with the kubernetes cluster or has VPC peering set up between
the VPC of the kubernetes cluster. Once the database is provisioned, you should be able to see the following page. Take
a note of the endpoint marked by the red box.</p><p><img loading="lazy" alt="AWS RDS" src="/assets/images/aws-rds-bf6c0fee9db2d5bac76a8f5d2699f765.png" width="3724" height="1386" class="img_ev3q"></p><p>First, add the DB password to kubernetes by running the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete secret mysql-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic mysql-secrets --from-literal=mysql-root-password=&lt;&lt;password&gt;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Update the sql settings under global in the values.yaml as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sql:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    datasource:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      host: &quot;&lt;&lt;rds-endpoint&gt;&gt;:3306&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      hostForMysqlClient: &quot;&lt;&lt;rds-endpoint&gt;&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      port: &quot;3306&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: &quot;jdbc:mysql://&lt;&lt;rds-endpoint&gt;&gt;:3306/datahub?verifyServerCertificate=false&amp;useSSL=true&amp;useUnicode=yes&amp;characterEncoding=UTF-8&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      driver: &quot;com.mysql.jdbc.Driver&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      username: &quot;root&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      password:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretRef: mysql-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretKey: mysql-root-password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="elasticsearch-service">Elasticsearch Service<a class="hash-link" href="#elasticsearch-service" title="Direct link to heading">​</a></h3><p>Provision an elasticsearch domain running elasticsearch version 7.9 or above that shares the VPC with the kubernetes
cluster or has VPC peering set up between the VPC of the kubernetes cluster. Once the domain is provisioned, you should
be able to see the following page. Take a note of the endpoint marked by the red box.</p><p><img loading="lazy" alt="AWS Elasticsearch Service" src="/assets/images/aws-elasticsearch-938752b80fce89de4b06290e50b04e1d.png" width="2918" height="620" class="img_ev3q"></p><p>Update the elasticsearch settings under global in the values.yaml as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearch:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host: &lt;&lt;elasticsearch-endpoint&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    port: &quot;443&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    useSSL: &quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also allow communication via HTTP (without SSL) by using the settings below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearch:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host: &lt;&lt;elasticsearch-endpoint&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    port: &quot;80&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you have fine-grained access control enabled with basic authentication, first run the following to create a k8s
secret with the password.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete secret elasticsearch-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic elasticsearch-secrets --from-literal=elasticsearch-password=&lt;&lt;password&gt;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then use the settings below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearch:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host: &lt;&lt;elasticsearch-endpoint&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    port: &quot;443&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    useSSL: &quot;true&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    auth:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      username: &lt;&lt;username&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      password:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretRef: elasticsearch-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretKey: elasticsearch-password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lastly, you <strong>NEED</strong> to set the following env variable for <strong>elasticsearchSetupJob</strong>. AWS Elasticsearch/Opensearch
service uses OpenDistro version of Elasticsearch, which does not support the &quot;datastream&quot; functionality. As such, we use
a different way of creating time based indices.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearchSetupJob:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    image:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      repository: linkedin/datahub-elasticsearch-setup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      tag: &quot;***&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    extraEnvs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      - name: USE_AWS_ELASTICSEARCH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        value: &quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><p><strong>Note:</strong>
If you have a custom setup of elastic search cluster and are deploying through docker, you can modify the configurations
in datahub to point to the specific ES instance -</p><ol><li>If you are using <code>docker quickstart</code> you can modify the hostname and port of the ES instance in docker compose
quickstart files located <a href="https://github.com/datahub-project/datahub/blob/master/docker/quickstart/" target="_blank" rel="noopener noreferrer">here</a>.<ol><li>Once you have modified the quickstart recipes you can run the quickstart command using a specific docker compose
file. Sample command for that is<ul><li><code>datahub docker quickstart --quickstart-compose-file docker/quickstart/docker-compose-without-neo4j.quickstart.yml</code></li></ul></li></ol></li><li>If you are not using quickstart recipes, you can modify environment variable in GMS to point to the ES instance. The
env files for datahub-gms are located <a href="https://github.com/datahub-project/datahub/blob/master/docker/datahub-gms/env/" target="_blank" rel="noopener noreferrer">here</a>.</li></ol><p>Further, you can find a list of properties supported to work with a custom ES
instance <a href="https://github.com/datahub-project/datahub/blob/master/metadata-service/factories/src/main/java/com/linkedin/gms/factory/common/ElasticsearchSSLContextFactory.java" target="_blank" rel="noopener noreferrer">here</a>
and <a href="https://github.com/datahub-project/datahub/blob/master/metadata-service/factories/src/main/java/com/linkedin/gms/factory/common/RestHighLevelClientFactory.java" target="_blank" rel="noopener noreferrer">here</a>
.</p><p>A mapping between the property name used in the above two files and the name used in docker/env file can be
found <a href="https://github.com/datahub-project/datahub/blob/master/metadata-service/factories/src/main/resources/application.yml" target="_blank" rel="noopener noreferrer">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="managed-streaming-for-apache-kafka-msk">Managed Streaming for Apache Kafka (MSK)<a class="hash-link" href="#managed-streaming-for-apache-kafka-msk" title="Direct link to heading">​</a></h3><p>Provision an MSK cluster that shares the VPC with the kubernetes cluster or has VPC peering set up between the VPC of
the kubernetes cluster. Once the domain is provisioned, click on the “View client information” button in the ‘Cluster
Summary” section. You should see a page like below. Take a note of the endpoints marked by the red boxes.</p><p><img loading="lazy" alt="AWS MSK" src="/assets/images/aws-msk-b31bc0807c69c546974e922a2079cb1c.png" width="1224" height="1386" class="img_ev3q"></p><p>Update the kafka settings under global in the values.yaml as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kafka:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bootstrap:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      server: &quot;&lt;&lt;bootstrap-server endpoint&gt;&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    zookeeper:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      server:  &quot;&lt;&lt;zookeeper endpoint&gt;&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    schemaregistry:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: &quot;http://prerequisites-cp-schema-registry:8081&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    partitions: 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    replicationFactor: 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note, the number of partitions and replicationFactor should match the number of bootstrap servers. This is by default 3
for AWS MSK.</p><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aws-glue-schema-registry">AWS Glue Schema Registry<a class="hash-link" href="#aws-glue-schema-registry" title="Direct link to heading">​</a></h3><blockquote><p><strong>WARNING</strong>: AWS Glue Schema Registry DOES NOT have a python SDK. As such, python based libraries like ingestion or datahub-actions (UI ingestion) is not supported when using AWS Glue Schema Registry</p></blockquote><p>You can use AWS Glue schema registry instead of the kafka schema registry. To do so, first provision an AWS Glue schema
registry in the &quot;Schema Registry&quot; tab in the AWS Glue console page.</p><p>Once the registry is provisioned, you can change helm chart as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kafka:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bootstrap:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    zookeeper:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    schemaregistry:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: AWS_GLUE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      glue:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        region: &lt;&lt;AWS region of registry&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        registry: &lt;&lt;name of registry&gt;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note, it will use the name of the topic as the schema name in the registry.</p><p>Before you update the pods, you need to give the k8s worker nodes the correct permissions to access the schema registry.</p><p>The minimum permissions required looks like this</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetRegistry&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:ListRegistries&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:CreateSchema&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:UpdateSchema&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchema&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:ListSchemas&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:RegisterSchemaVersion&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaByDefinition&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaVersion&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaVersionsDiff&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:ListSchemaVersions&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:CheckSchemaVersionValidity&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:PutSchemaVersionMetadata&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:QuerySchemaVersionMetadata&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;arn:aws:glue:*:795586375822:schema/*&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;arn:aws:glue:us-west-2:795586375822:registry/demo-shared&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;*&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The latter part is required to have &quot;*&quot; as the resource because of an issue in the AWS Glue schema registry library.
Refer to <a href="https://github.com/awslabs/aws-glue-schema-registry/issues/68" target="_blank" rel="noopener noreferrer">this issue</a> for any updates.</p><p>Glue currently doesn&#x27;t support AWS Signature V4. As such, we cannot use service accounts to give permissions to access
the schema registry. The workaround is to give the above permission to the EKS worker node&#x27;s IAM role. Refer
to <a href="https://github.com/awslabs/aws-glue-schema-registry/issues/69" target="_blank" rel="noopener noreferrer">this issue</a> for any updates.</p><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><p>Note, you will be seeing log &quot;Schema Version Id is null. Trying to register the schema&quot; on every request. This log is
misleading, so should be ignored. Schemas are cached, so it does not register a new version on every request (aka no
performance issues). This has been fixed by <a href="https://github.com/awslabs/aws-glue-schema-registry/pull/64" target="_blank" rel="noopener noreferrer">this PR</a> but
the code has not been released yet. We will update version once a new release is out.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-policies-for-ui-based-ingestion">IAM policies for UI-based ingestion<a class="hash-link" href="#iam-policies-for-ui-based-ingestion" title="Direct link to heading">​</a></h3><p>This section details how to attach policies to the acryl-datahub-actions pod that powers UI-based ingestion. For some of
the ingestion recipes, you sepecify login creds in the recipe itself, making it easy to set up auth to grab metadata
from the data source. However, for AWS resources, the recommendation is to use IAM roles and policies to gate requests
to access metadata on these resources.</p><p>To do this, let&#x27;s follow
this <a href="https://docs.aws.amazon.com/eks/latest/userguide/create-service-account-iam-policy-and-role.html" target="_blank" rel="noopener noreferrer">guide</a> to
associate a kubernetes service account with an IAM role. Then we can attach this IAM role to the acryl-datahub-actions
pod to let the pod assume the specified role.</p><p>First, you must create an IAM policy with all the permissions needed to run ingestion. This is specific to each
connector and the set of metadata you are trying to pull. i.e. profiling requires more permissions, since it needs
access to the data, not just the metadata. Let&#x27;s say assume the ARN of that policy
is <code>arn:aws:iam::&lt;&lt;account-id&gt;&gt;:policy/policy1</code>.</p><p>Then, create a service account with the policy attached is to use <a href="https://eksctl.io/" target="_blank" rel="noopener noreferrer">eksctl</a>. You can run the
following command to do so.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create iamserviceaccount \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &lt;&lt;service-account-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --namespace &lt;&lt;namespace&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --cluster &lt;&lt;eks-cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --attach-policy-arn &lt;&lt;policy-ARN&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --approve \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --override-existing-serviceaccounts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example, running the following will create a service account &quot;acryl-datahub-actions&quot; in the datahub namespace of
datahub EKS cluster with <code>arn:aws:iam::&lt;&lt;account-id&gt;&gt;:policy/policy1</code> attached.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create iamserviceaccount \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name acryl-datahub-actions \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --namespace datahub \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --cluster datahub \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --attach-policy-arn arn:aws:iam::&lt;&lt;account-id&gt;&gt;:policy/policy1 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --approve \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --override-existing-serviceaccounts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lastly, in the helm values.yaml, you can add the following to the acryl-datahub-actions to attach the service account to
the acryl-datahub-actions pod.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">acryl-datahub-actions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">serviceAccount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &lt;&lt;service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/datahub-project/datahub/blob/master/docs/deploy/aws.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/act-on-metadata/impact-analysis"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lineage Impact Analysis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/deploy/gcp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying to GCP</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#start-up-a-kubernetes-cluster-on-aws-eks" class="table-of-contents__link toc-highlight">Start up a kubernetes cluster on AWS EKS</a></li><li><a href="#setup-datahub-using-helm" class="table-of-contents__link toc-highlight">Setup DataHub using Helm</a></li><li><a href="#expose-endpoints-using-a-load-balancer" class="table-of-contents__link toc-highlight">Expose endpoints using a load balancer</a></li><li><a href="#use-aws-managed-services-for-the-storage-layer" class="table-of-contents__link toc-highlight">Use AWS managed services for the storage layer</a><ul><li><a href="#rds" class="table-of-contents__link toc-highlight">RDS</a></li><li><a href="#elasticsearch-service" class="table-of-contents__link toc-highlight">Elasticsearch Service</a></li><li><a href="#managed-streaming-for-apache-kafka-msk" class="table-of-contents__link toc-highlight">Managed Streaming for Apache Kafka (MSK)</a></li><li><a href="#aws-glue-schema-registry" class="table-of-contents__link toc-highlight">AWS Glue Schema Registry</a></li><li><a href="#iam-policies-for-ui-based-ingestion" class="table-of-contents__link toc-highlight">IAM policies for UI-based ingestion</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/townhalls">Town Halls</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/#adoption">Adoption</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/demo">Demo</a></li><li class="footer__item"><a href="https://feature-requests.datahubproject.io/roadmap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roadmap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">Contributing</a></li><li class="footer__item"><a href="https://github.com/datahub-project/datahub" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2015-2022 DataHub Project Authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.41cec5e1.js"></script>
<script src="/assets/js/main.528bc9eb.js"></script>
</body>
</html>