"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[2634],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>p});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,l=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=c(n),p=i,h=u["".concat(l,".").concat(p)]||u[p]||d[p]||s;return n?a.createElement(h,r(r({ref:t},m),{},{components:n})):a.createElement(h,r({ref:t},m))}));function p(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=n.length,r=new Array(s);r[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var c=2;c<s;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},95793:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(67294),i=n(86010);const s="availabilityCard_P5od",r="managedIcon_AxXO",o="platform_wqXv",l="platformAvailable_Y8lN";var c=n(1413);const m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"}}]},name:"close-circle",theme:"filled"};var d=n(32257),u=function(e,t){return a.createElement(d.Z,(0,c.Z)((0,c.Z)({},e),{},{ref:t,icon:m}))};u.displayName="CloseCircleFilled";const p=a.forwardRef(u);const h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};var g=function(e,t){return a.createElement(d.Z,(0,c.Z)((0,c.Z)({},e),{},{ref:t,icon:h}))};g.displayName="CheckCircleFilled";const f=a.forwardRef(g);const b={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 418.7C765.6 297.9 648.9 212 512.2 212S258.8 297.8 213 418.6C127.3 441.1 64 519.1 64 612c0 110.5 89.5 200 199.9 200h496.2C870.5 812 960 722.5 960 612c0-92.7-63.1-170.7-148.6-193.3zm36.3 281a123.07 123.07 0 01-87.6 36.3H263.9c-33.1 0-64.2-12.9-87.6-36.3A123.3 123.3 0 01140 612c0-28 9.1-54.3 26.2-76.3a125.7 125.7 0 0166.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10c54.3 14.5 92.1 63.8 92.1 120 0 33.1-12.9 64.3-36.3 87.7z"}}]},name:"cloud",theme:"outlined"};var y=function(e,t){return a.createElement(d.Z,(0,c.Z)((0,c.Z)({},e),{},{ref:t,icon:b}))};y.displayName="CloudOutlined";const v=a.forwardRef(y),w=e=>{let{saasOnly:t,ossOnly:n}=e;return a.createElement("div",{className:(0,i.Z)(s,"card")},a.createElement("strong",null,"Feature Availability"),a.createElement("div",null,a.createElement("span",{className:(0,i.Z)(o,!t&&l)},"Self-Hosted DataHub ",t?a.createElement(p,null):a.createElement(f,null))),a.createElement("div",null,a.createElement(v,{className:r}),a.createElement("span",{className:(0,i.Z)(o,!n&&l)},"Managed DataHub ",n?a.createElement(p,null):a.createElement(f,null))))}},98802:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>m});var a=n(87462),i=(n(67294),n(3905)),s=n(95793);const r={title:"About DataHub [Stemming and Synonyms Support]",sidebar_label:"[Stemming and Synonyms Support]",slug:"/architecture/stemming_and_synonyms",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/stemming_and_synonyms.md"},o="About DataHub [Stemming and Synonyms Support]",l={unversionedId:"docs/architecture/stemming_and_synonyms",id:"docs/architecture/stemming_and_synonyms",title:"About DataHub [Stemming and Synonyms Support]",description:"This feature adds features to our current search implementation in an effort to make search results more relevant. Included improvements are:",source:"@site/genDocs/docs/architecture/stemming_and_synonyms.md",sourceDirName:"docs/architecture",slug:"/architecture/stemming_and_synonyms",permalink:"/docs/architecture/stemming_and_synonyms",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/stemming_and_synonyms.md",tags:[],version:"current",frontMatter:{title:"About DataHub [Stemming and Synonyms Support]",sidebar_label:"[Stemming and Synonyms Support]",slug:"/architecture/stemming_and_synonyms",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/stemming_and_synonyms.md"},sidebar:"overviewSidebar",previous:{title:"Sync Status",permalink:"/docs/sync-status"},next:{title:"Lineage",permalink:"/docs/lineage/lineage-feature-guide"}},c={},m=[{value:"Stemming and Synonyms Support Setup, Prerequisites, and Permissions",id:"stemming-and-synonyms-support-setup-prerequisites-and-permissions",level:2},{value:"Helm Values",id:"helm-values",level:3},{value:"Docker Environment Variables",id:"docker-environment-variables",level:3},{value:"Using Stemming and Synonyms Support",id:"using-stemming-and-synonyms-support",level:2},{value:"Stemming",id:"stemming",level:3},{value:"Urn Matching",id:"urn-matching",level:3},{value:"Synonyms",id:"synonyms",level:3},{value:"Autocomplete improvements",id:"autocomplete-improvements",level:3},{value:"Additional Resources",id:"additional-resources",level:2},{value:"Videos",id:"videos",level:3},{value:"FAQ and Troubleshooting",id:"faq-and-troubleshooting",level:2}],d={toc:m};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"about-datahub-stemming-and-synonyms-support"},"About DataHub ","[Stemming and Synonyms Support]"),(0,i.kt)(s.Z,{mdxType:"FeatureAvailability"}),(0,i.kt)("p",null,"This feature adds features to our current search implementation in an effort to make search results more relevant. Included improvements are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'Stemming - Using a multi-language stemmer to allow better partial matching based on lexicographical roots i.e. "log" resolves from logs, logging. logger etc.'),(0,i.kt)("li",{parentName:"ul"},"Urn matching - Both partial and full Urns previously did not give desirable behavior in search results, these are now properly indexed and queried to give better matching results"),(0,i.kt)("li",{parentName:"ul"},'Word breaks across special characters - Previously when typing in a query like "logging_events", autocomplete would fail to resolve results after typing in the underscore until at least "logging_eve" had been typed and the same would occur with spaces. This has been resolved.'),(0,i.kt)("li",{parentName:"ul"},"Synonyms - A list of synonyms that will match across search results, currently static, has been added. We will be evolving this list over time to improve matching jargon versions of words to their full word equivalent. For example, typing in staging in a query can resolve datasets with stg in their name.")),(0,i.kt)("h2",{id:"stemming-and-synonyms-support-setup-prerequisites-and-permissions"},"[Stemming and Synonyms Support]"," Setup, Prerequisites, and Permissions"),(0,i.kt)("p",null,"A reindex is required for this feature to work as it modifies non-dynamic mappings and settings in the index. This reindex is carried out as a part of the bootstrapping process by\nDataHub Upgrade which has been added to the helm charts and docker-compose files as a required component with default configurations that should work for most deployments.\nThe job uses existing credentials and permissions for ElasticSearch to achieve this. During the reindex, writes to ElasticSearch will fail, so it is recommended to schedule an outage during this time. If doing a rolling update, old versions of GMS should still be able to serve queries, but at minimum ingestion traffic needs to be stopped. Estimated downtime for instances on the order of a few million records is ~30 minutes. Larger instances may require several hours though.\nOnce the reindex has succeeded, a message will be sent to new GMS and MCL/MAE Consumer instances that the state is ready for them to start up. Until this time they will hold off on starting using an exponential backoff to check for readiness."),(0,i.kt)("p",null,"Relevant configuration for the Upgrade Job:"),(0,i.kt)("h3",{id:"helm-values"},"Helm Values"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'global:\n  elasticsearch:\n    ## The following section controls when and how reindexing of elasticsearch indices are performed\n    index:\n      ## Enable reindexing when mappings change based on the data model annotations\n      enableMappingsReindex: false\n\n      ## Enable reindexing when static index settings change.\n      ## Dynamic settings which do not require reindexing are not affected\n      ## Primarily this should be enabled when re-sharding is necessary for scaling/performance.\n      enableSettingsReindex: false\n\n      ## Index settings can be overridden for entity indices or other indices on an index by index basis\n      ## Some index settings, such as # of shards, requires reindexing while others, i.e. replicas, do not\n      ## Non-Entity indices do not require the prefix\n      # settingsOverrides: \'{"graph_service_v1":{"number_of_shards":"5"},"system_metadata_service_v1":{"number_of_shards":"5"}}\'\n      ## Entity indices do not require the prefix or suffix\n      # entitySettingsOverrides: \'{"dataset":{"number_of_shards":"10"}}\'\n\n      ## The amount of delay between indexing a document and having it returned in queries\n      ## Increasing this value can improve performance when ingesting large amounts of data\n      # refreshIntervalSeconds: 1\n\n      ## The following options control settings for datahub-upgrade job when creating or reindexing indices\n      upgrade:\n        enabled: true\n\n        ## When reindexing is required, this option will clone the existing index as a backup\n        ## The clone indices are not currently managed.\n        # cloneIndices: true\n\n        ## Typically when reindexing the document counts between the original and destination indices should match.\n        ## In some cases reindexing might not be able to proceed due to incompatibilities between a document in the\n        ## orignal index and the new index\'s mappings. This document could be dropped and re-ingested or restored from\n        ## the SQL database.\n        ##\n        ## This setting allows continuing if and only if the cloneIndices setting is also enabled which\n        ## ensures a complete backup of the original index is preserved.\n        # allowDocCountMismatch: false\n')),(0,i.kt)("h3",{id:"docker-environment-variables"},"Docker Environment Variables"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_INDEX_BUILDER_MAPPINGS_REINDEX - Controls whether to perform a reindex for mappings mismatches"),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_INDEX_BUILDER_SETTINGS_REINDEX - Controls whether to perform a reindex for settings mismatches"),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_BUILD_INDICES_ALLOW_DOC_COUNT_MISMATCH - Used in conjunction with ELASTICSEARCH_BUILD_INDICES_CLONE_INDICES to allow users to skip passed document count mismatches when reindexing. Count mismatches may indicate dropped records during the reindex, so to prevent data loss this is only allowed if cloning is enabled."),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_BUILD_INDICES_CLONE_INDICES - Enables creating a clone of the current index to prevent data loss, default true"),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_BUILD_INDICES_INITIAL_BACK_OFF_MILLIS - Controls the GMS and MCL Consumer backoff for checking if the reindex process has completed during start up. It is recommended to leave the defaults which will result in waiting up to ~5 minutes before killing the start-up process, allowing a new pod to attempt to start up in orchestrated deployments."),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_BUILD_INDICES_MAX_BACK_OFFS"),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_BUILD_INDICES_BACK_OFF_FACTOR"),(0,i.kt)("li",{parentName:"ul"},"ELASTICSEARCH_BUILD_INDICES_WAIT_FOR_BUILD_INDICES - Controls whether to require waiting for the Build Indices job to finish. Defaults to true. It is not recommended to change this as it will allow GMS and MCL Consumers to start up in an error state.")),(0,i.kt)("h2",{id:"using-stemming-and-synonyms-support"},"Using ","[Stemming and Synonyms Support]"),(0,i.kt)("h3",{id:"stemming"},"Stemming"),(0,i.kt)("p",null,"Stemming uses the root of a word without suffixes to match across intent of the search when a user is not quite sure of the precise name of a resource."),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimization/eso-stemming_1.png"})),(0,i.kt)("p",null,'In this first image stemming is shown in the results. Even though the query is "event", the results contain instances with "events."'),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimization/eso-stemming_2.png"})),(0,i.kt)("p",null,'The second image exemplifies stemming on a query. The query is for "events", but the results show resources containing "event" as well.'),(0,i.kt)("h3",{id:"urn-matching"},"Urn Matching"),(0,i.kt)("p",null,"Previously queries were not properly parsing out and tokenizing the expected portions of Urn types. Changes have been made on the index mapping and query side to support various partial and full Urn matching."),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-exact_match.png"})),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-partial_urn_1.png"})),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-partial_urn_2.png"})),(0,i.kt)("h3",{id:"synonyms"},"Synonyms"),(0,i.kt)("p",null,"Synonyms includes a static list of equivalent terms that are baked into the index at index creation time. This allows for efficient indexing of related terms. It is possible to add these to the query side as well to\nallow for dynamic synonyms, but this is unsupported at this time and has performance implications."),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-synonyms_1.png"})),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-synonyms_2.png"})),(0,i.kt)("h3",{id:"autocomplete-improvements"},"Autocomplete improvements"),(0,i.kt)("p",null,"Improvements were made to autocomplete handling around special characters like underscores and spaces."),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-autocomplete_1.png"})),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-autocomplete_2.png"})),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/elasticsearch_optimizations/eso-autocomplete_3.png"})),(0,i.kt)("h2",{id:"additional-resources"},"Additional Resources"),(0,i.kt)("h3",{id:"videos"},"Videos"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"DataHub TownHall: Search Improvements Preview")),(0,i.kt)("p",{align:"center"},(0,i.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/ECxIMbKwuOY?start=1529",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0})),(0,i.kt)("h2",{id:"faq-and-troubleshooting"},"FAQ and Troubleshooting"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Need more help? Join the conversation in ",(0,i.kt)("a",{parentName:"em",href:"http://slack.datahubproject.io"},"Slack"),"!")))}u.isMDXComponent=!0}}]);