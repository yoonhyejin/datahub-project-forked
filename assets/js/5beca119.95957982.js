"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[4904],{3905:(e,t,a)=>{a.d(t,{Zo:()=>l,kt:()=>p});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=r.createContext({}),d=function(e){var t=r.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},l=function(e){var t=d(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),h=d(a),p=n,m=h["".concat(c,".").concat(p)]||h[p]||u[p]||o;return a?r.createElement(m,i(i({ref:t},l),{},{components:a})):r.createElement(m,i({ref:t},l))}));function p(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var d=2;d<o;d++)i[d]=a[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},87693:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var r=a(87462),n=(a(67294),a(3905));const o={title:"Serving Tier",sidebar_label:"Serving Tier",slug:"/architecture/metadata-serving",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/metadata-serving.md"},i="DataHub Serving Architecture",s={unversionedId:"docs/architecture/metadata-serving",id:"docs/architecture/metadata-serving",title:"Serving Tier",description:"The figure below shows the high-level system diagram for DataHub's Serving Tier.",source:"@site/genDocs/docs/architecture/metadata-serving.md",sourceDirName:"docs/architecture",slug:"/architecture/metadata-serving",permalink:"/docs/architecture/metadata-serving",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/metadata-serving.md",tags:[],version:"current",frontMatter:{title:"Serving Tier",sidebar_label:"Serving Tier",slug:"/architecture/metadata-serving",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/metadata-serving.md"},sidebar:"overviewSidebar",previous:{title:"Ingestion Framework",permalink:"/docs/architecture/metadata-ingestion"},next:{title:"See DataHub in Action",permalink:"/docs/demo"}},c={},d=[{value:"DataHub Serving Tier Components",id:"datahub-serving-tier-components",level:2},{value:"Metadata Storage",id:"metadata-storage",level:3},{value:"Metadata Change Log Stream (MCL)",id:"metadata-change-log-stream-mcl",level:3},{value:"Metadata Index Applier (mae-consumer-job)",id:"metadata-index-applier-mae-consumer-job",level:3},{value:"Metadata Query Serving",id:"metadata-query-serving",level:3}],l={toc:d};function u(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,r.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"datahub-serving-architecture"},"DataHub Serving Architecture"),(0,n.kt)("p",null,"The figure below shows the high-level system diagram for DataHub's Serving Tier. "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"datahub-serving",src:a(11360).Z,width:"2936",height:"1658"})),(0,n.kt)("p",null,"The primary component is called ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/metadata-service"},"the Metadata Service")," and exposes a REST API and a GraphQL API for performing CRUD operations on metadata. The service also exposes search and graph query API-s to support secondary-index style queries, full-text search queries as well as relationship queries like lineage. In addition, the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/datahub-frontend"},"datahub-frontend")," service expose a GraphQL API on top of the metadata graph. "),(0,n.kt)("h2",{id:"datahub-serving-tier-components"},"DataHub Serving Tier Components"),(0,n.kt)("h3",{id:"metadata-storage"},"Metadata Storage"),(0,n.kt)("p",null,"The DataHub Metadata Service persists metadata in a document store (an RDBMS like MySQL, Postgres, or Cassandra, etc.). "),(0,n.kt)("h3",{id:"metadata-change-log-stream-mcl"},"Metadata Change Log Stream (MCL)"),(0,n.kt)("p",null,"The DataHub Service Tier also emits a commit event ",(0,n.kt)("a",{parentName:"p",href:"/docs/what/mxe#metadata-change-log-mcl"},"Metadata Change Log")," when a metadata change has been successfully committed to persistent storage. This event is sent over Kafka. "),(0,n.kt)("p",null,"The MCL stream is a public API and can be subscribed to by external systems (for example, the Actions Framework) providing an extremely powerful way to react in real-time to changes happening in metadata. For example, you could build an access control enforcer that reacts to change in metadata (e.g. a previously world-readable dataset now has a pii field) to immediately lock down the dataset in question.\nNote that not all MCP-s will result in an MCL, because the DataHub serving tier will ignore any duplicate changes to metadata."),(0,n.kt)("h3",{id:"metadata-index-applier-mae-consumer-job"},"Metadata Index Applier (mae-consumer-job)"),(0,n.kt)("p",null,"[Metadata Change Logs]","s are consumed by another Kafka Streams job, ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/metadata-jobs/mae-consumer-job"},"mae-consumer-job"),", which applies the changes to the ",(0,n.kt)("a",{parentName:"p",href:"/docs/what/graph"},"graph")," and ",(0,n.kt)("a",{parentName:"p",href:"/docs/what/search-index"},"search index")," accordingly.\nThe job is entity-agnostic and will execute corresponding graph & search index builders, which will be invoked by the job when a specific metadata aspect is changed.\nThe builder should instruct the job how to update the graph and search index based on the metadata change. "),(0,n.kt)("p",null,"To ensure that metadata changes are processed in the correct chronological order, MCLs are keyed by the entity ",(0,n.kt)("a",{parentName:"p",href:"/docs/what/urn"},"URN")," \u2014 meaning all MAEs for a particular entity will be processed sequentially by a single Kafka streams thread. "),(0,n.kt)("h3",{id:"metadata-query-serving"},"Metadata Query Serving"),(0,n.kt)("p",null,"Primary-key based reads (e.g. getting schema metadata for a dataset based on the ",(0,n.kt)("inlineCode",{parentName:"p"},"dataset-urn"),") on metadata are routed to the document store. Secondary index based reads on metadata are routed to the search index (or alternately can use the strongly consistent secondary index support described ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/docs/architecture/"},"here"),"). Full-text and advanced search queries are routed to the search index. Complex graph queries such as lineage are routed to the graph index."))}u.isMDXComponent=!0},11360:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/datahub-serving-0a1f223ecb2d809052fd1eed539b0b3a.png"}}]);